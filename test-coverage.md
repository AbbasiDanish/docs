---
title: Test Coverage
description: Code coverage is a metric used to measure the percentage of code that is executed during testing. This can help developers identify parts of their code that may not be tested or that have low coverage, indicating a potential risk for bugs and other issues.
---

# Test Coverage

**Requires [XDebug 3.0+](https://xdebug.org/docs/install/)**, or [PCOV](https://github.com/krakjoe/pcov), or [PHPDBG](https://www.php.net/manual/en/book.phpdbg.php).

Test Coverage (or Code coverage) is a metric used to measure the percentage of code that is executed during testing. This can help developers identify parts of their code that may not be tested or that have low coverage, indicating a potential risk for bugs and other issues.

Typically, the essential configuration is already present in the `phpunit.xml` file provided by frameworks or generated by executing the `./vendor/bin/pest --init` command. But if it's not there, make sure to specify the paths to your project in the "phpunit.xml" file.

```xml
    ...
    <coverage>
        <include>
            <directory suffix=".php">./app</directory>
        </include>
    </coverage>
    ...
```

In addition to setting up the `phpunit.xml` file, you will also need to install [XDebug 3.0+](https://xdebug.org/docs/install/), [PCOV](https://github.com/krakjoe/pcov), or [PHPDBG](https://www.php.net/manual/en/book.phpdbg.php) to generate a code coverage report. Note that when utilizing XDebug, the `XDEBUG_MODE` environment variable must be configured as `coverage`.

Once you have configured the settings and installed a coverage driver, generating a code coverage report becomes effortless with the use of the `--coverage` option.

```bash
./vendor/bin/pest --coverage
```

By utilizing the `--coverage` option, the test suite runs normally, but with the additional feature of displaying a list of project files and their corresponding coverage results.

<div>
    <img src="/assets/img/coverage.png" style="display: block; margin-left: auto; margin-right: auto;" width="80%" height="600" />
</div>

If there are any uncovered lines in your current test suite, they will be highlighted in red and displayed using their respective line numbers. Multiple uncovered lines will be displayed with two dots `..` between them. For instance, if there is missing coverage between lines 52 and 60, you will see `52..60` instead of just `52` in red.

## Minimum Threshold Enforcement

To ensure comprehensive testing and maintain code quality, it is crucial to set minimum threshold values for coverage results. In Pest, you can use the `--coverage` option along with the `--min` option to define the minimum threshold values for coverage results. If the specified thresholds are not met, Pest will report a failure.

```bash
./vendor/bin/pest --coverage --min=90
```

<div>
    <img src="/assets/img/coverage-min.png" style="display: block; margin-left: auto; margin-right: auto;" width="80%" height="600" />
</div>

## Ignoring Code

If there are certain units of code that cannot be tested and should be excluded from code coverage analysis, you can use `@codeCoverageIgnoreStart` and `@codeCoverageIgnoreEnd` comments in your source code to achieve this.

```php
// @codeCoverageIgnoreStart
function getUsers() {
    //
}
// @codeCoverageIgnoreEnd
```

## Different Formats

As anticipated, various coverage formats are equally supported:
- `--coverage-clover <file>`: Save the code coverage report in Clover XML format to a specified file.
- `--coverage-cobertura <file>`: Save the code coverage report in Cobertura XML format to a specified file.
- `--coverage-crap4j <file>`: Save the code coverage report in Crap4J XML format to a specified file.
- `--coverage-html <dir>`: Save the code coverage report in HTML format to a specified directory.
- `--coverage-php <file>`: Serialize the code coverage data and save it to a specified file.
- `--coverage-text <file>`: Save the code coverage report in text format to a specified file. (Default: php://stdout)
- `--coverage-xml <dir>`: Save the code coverage report in XML format to a specified directory.

---

In this chapter, we discussed test coverage and its ability to aid in determining the thoroughness of testing for your application. In the following chapter, we will delve into the topic of custom helpers on Pest: [Custom Helpers](/docs/custom-helpers)
